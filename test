import { Component } from '@angular/core';
import * as fs from 'file-saver';
import * as ExcelJS from 'exceljs';

@Component({
  selector: 'app-export',
  templateUrl: './export.component.html',
  styleUrls: ['./export.component.css']
})
export class ExportComponent {
  rowDetails = [
    {
      "Mark 1": 90,
      "Mark 2": 100,
      "Mark 3": 70,
    },
    // Add more rows if needed
  ];

  commonColumnWidth = 100; // Set the common width in pixels

  exportToExcel(): void {
    if (this.rowDetails.length === 0) {
      return; // No data to export
    }

    const workbook = new ExcelJS.Workbook();
    const worksheet = workbook.addWorksheet('Sheet1');

    const columnNames = Object.keys(this.rowDetails[0]);

    // Set a common width for all columns
    columnNames.forEach((columnName, columnIndex) => {
      worksheet.getColumn(columnIndex + 1).width = this.commonColumnWidth;
    });

    // Make header cells bold
    worksheet.getRow(1).font = { bold: true };

    // Add data
    this.rowDetails.forEach(row => {
      const rowValues = [];
      columnNames.forEach(columnName => {
        rowValues.push(row[columnName]);
      });
      worksheet.addRow(rowValues);
    });

    // Generate the Excel file
    workbook.xlsx.writeBuffer().then(buffer => {
      const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
      const fileName = 'exported-data.xlsx';

      // Save the file using FileSaver.js
      fs.saveAs(blob, fileName);
    });
  }
}
