import * as XLSX from 'xlsx';

export class ExportComponent {
  rowDetails = [
    {
      mark1: 90,
      mark2: 100,
      mark3: 70,
    },
    {
      mark1: 90,
      mark2: 100,
      mark3: 70,
    },
    {
      mark1: 90,
      mark2: 100,
      mark3: 70,
    },
  ];

  columnDetails = [
    {
      fieldName: 'mark1',
      columnTitle: 'Tamil',
      minWidth: 10, // Minimum width for the column (adjust as needed)
    },
    {
      fieldName: 'mark2',
      columnTitle: 'English',
      minWidth: 10, // Minimum width for the column (adjust as needed)
    },
    {
      fieldName: 'mark3',
      columnTitle: 'Maths',
      minWidth: 10, // Minimum width for the column (adjust as needed)
    },
  ];

  exportToExcel(): void {
    // Map the data columns to custom titles
    const dataWithCustomColumns = this.rowDetails.map((row) => {
      const newRow = {};
      for (const columnDetail of this.columnDetails) {
        const fieldName = columnDetail.fieldName;
        const columnTitle = columnDetail.columnTitle;
        newRow[columnTitle] = row[fieldName];
      }
      return newRow;
    });

    const ws: XLSX.WorkSheet = XLSX.utils.json_to_sheet(dataWithCustomColumns);
    const wb: XLSX.WorkBook = XLSX.utils.book_new();

    // Apply bold style to column titles
    const wsCols = [];
    for (const columnDetail of this.columnDetails) {
      wsCols.push({ wch: columnDetail.minWidth, s: { font: { bold: true } } });
    }
    ws['!cols'] = wsCols;

    XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
    XLSX.writeFile(wb, 'exported-data.xlsx');
  }
}
