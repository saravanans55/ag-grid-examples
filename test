import { Component } from '@angular/core';
import * as ExcelJS from 'exceljs';

@Component({
  selector: 'app-export',
  templateUrl: './export.component.html',
  styleUrls: ['./export.component.css']
})
export class ExportComponent {
  rowDetails = [
    {
      mark1: 90,
      mark2: 100,
      mark3: 70,
    },
    {
      mark1: 90,
      mark2: 100,
      mark3: 70,
    },
    {
      mark1: 90,
      mark2: 100,
      mark3: 70,
    },
  ];

  columnDetails = [
    {
      fieldName: 'mark1',
      columnTitle: 'Tamil',
      minWidth: 10,
    },
    {
      fieldName: 'mark2',
      columnTitle: 'English',
      minWidth: 10,
    },
    {
      fieldName: 'mark3',
      columnTitle: 'Maths',
      minWidth: 10,
    },
  ];

  exportToExcel(): void {
    const workbook = new ExcelJS.Workbook();
    const worksheet = workbook.addWorksheet('Sheet1');

    // Define column headers with custom titles and formatting
    worksheet.addRow(this.columnDetails.map(column => column.columnTitle));
    const headerRow = worksheet.getRow(1);
    headerRow.eachCell((cell, colNumber) => {
      cell.font = { bold: true }; // Make the column titles bold
      worksheet.getColumn(colNumber).width = columnDetails[colNumber - 1].minWidth; // Set minimum width
    });

    // Add data to the worksheet
    this.rowDetails.forEach(row => {
      worksheet.addRow(this.columnDetails.map(column => row[column.fieldName]));
    });

    // Create and save
